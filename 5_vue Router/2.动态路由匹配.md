# 动态路由匹配

## 带参数的动态路由匹配

在 path 中冒号后面的为路径参数, 比如下例的 id "属于" user, 还可以是 "/user/:id/post:postId" 这样的形式。

在 route.params 中以对象的形式保存 路径参数 即: {id: 123, postId: 456}, 在组件中可用 route.params.id 进行访问。

浏览器中url: /user/123/post/456

```js
import User from "./views/User.vue";
import { createRouter, createWebHashHistory } from "vue-router";

const router = createRouter({
  history: createWebHashHistory(),
  routes: [
    {
      name: "user",
      path: "/user/:id",
      component: User,
    },
  ],
});

export default router;
```

## 响应路由参数的变化

vue 会复用组件, 而不是重新创建, 所以一些生命周期钩子就失效了, 但可以用 watch 监听路由参数的变化。

```js
import { watch } from "vue";
import { useRoute } from "vue-router";

const route = useRoute();

watch(
  () => route.params,
  (newVal, oldVal) => {
    // 执行相关操作
  }
);
```

用导航守卫(后续详细介绍)

```js
import { onBeforeRouteUpdate } from "vue-router";

onBeforeRouteUpdate(async (to, from) => {
  userData.value = await fetchUser(to.params.id);
});
```

## 捕获所有路由或 404 Not found 路由

在访问一些路由时, 可能不存在, 这时可以用一个空的组件作为 404 Not found 路由。

```js
// router.js

const routes = [
  {
    path: "/pathMatch(.*)*",
    component: () => import("./views/NotFound.vue"),
  },
  {
    path: "/user-:afterUser(.*)",
    component: () => import("./views/UserGenertic.vue"),
  },
];
```

## 本章总结

主要讲了动态路由匹配的相关知识, 包括带参数的动态路由匹配, 响应路由参数的变化, 捕获所有路由或 404 Not found 路由。