# 数据获取

有两种方式

## 导航完成后获取数据

即初级页面渲染完成后, 通过触发一些函数来获取数据, 然后渲染到页面上。

```javascript
import { ref, watch } from "vue";
import { useRoute } from "vue-router";
import { getPost } from "./api.js";

const route = useRoute();

const loading = ref(false);
const post = ref(null);
const error = ref(null);

// 侦听路由的参数，以便再次获取数据
watch(() => route.params.id, fetchData, { immediate: true });

async function fetchData(id) {
  error.value = post.value = null;
  loading.value = true;

  try {
    // 用获取数据的工具函数 / API 包裹器替换 `getPost`
    post.value = await getPost(id);
  } catch (err) {
    error.value = err.toString();
  } finally {
    loading.value = false;
  }
}
```

可以写一些加载中的提示

## 在导航完成前获取数据

在组合式API中, 一般用onmounted钩子函数来获取数据。

```javascript

import { onMounted } from "vue";
import { useRoute } from "vue-router";
import { getPost } from "./api.js";

const route = useRoute();

const post = ref(null);
const error = ref(null);

onMounted(async () => {
  try {
    // 用获取数据的工具函数 / API 包裹器替换 `getPost`
    post.value = await getPost(route.params.id);
  } catch (err) {
    error.value = err.toString();
  }
});
```


