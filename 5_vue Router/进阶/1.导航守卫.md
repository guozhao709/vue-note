# 导航守卫

导航守卫类似于一个"看门狗", 在路由发生变化时起作用, 执行一些操作, 如检查登录状态, 权限验证等。

## 全局前置守卫

全局前置守卫会在导航发生前执行, 比如下面这个例子:

```javascript
// main.js
router.beforeEach((to, from) => {
  const isLogin = localStorage.getItem("token");
  if (to.name === "User" && !isLogin) {
    return { name: "Login" };
  } else {
    return true;
  }
});
```

有第三个参数 next, 可以调用 next(), 但最新的版本中已经不推荐使用了。

用的是示例中的 return true, 表示放行, 继续执行后续的路由。

## 全局后置守卫

全局后置守卫会在导航后发生变化, 主要用于修改 index.html 等全局内容。

```javascript
// main.js
router.afterEach((to, from) => {
  document.title = to.meta.title;
});
```

## 全局解析守卫

用的比较少, 执行时机在 beforeEach 和 afterEach 之间。

```javascript
// main.js
router.beforeResolve((to, from) => {});
```

## 路由独享守卫

```javascript
// router.js
{
    path: "/user",
    name: "User",
    component: User,
    beforeEnter: (to, from) => {
    }
}
```

1. query 和 params 参数 变化时 不执行
2. 子级路由也适用, 但同级路由不适用, 必须父级路径发生变化

## 组件内守卫

有两个钩子(组合式 API)

1. beforeRouteEnter
2. beforeRouteUpdate

在组合式 api 中, 一般用 onMounted 结合 router.push()等 API 来实现页面跳转。
