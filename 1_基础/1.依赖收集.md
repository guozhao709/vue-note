# 依赖收集

当某个 响应式数据被读取（getter 被触发）时，Vue 会记录下“谁在用这个数据”；这些使用它的“地方”被称为它的“依赖”（通常是一个或多个 Watcher）。
之后当这个数据发生变化（setter 被触发）时，Vue 会通知这些依赖去更新。

即:

“谁用我，我就记住谁；等我变了，我再通知他。”

## 依赖收集的原理

当你对一个响应式数据进行 getter（读取）时，Vue 的依赖收集逻辑会做两件事：

1. 把当前正在运行的 effect（ReactiveEffect 实例）记录到这个响应式数据的依赖列表中(deps)

2. 同时把这个响应式数据的依赖集合（dep）记录到 effect.deps 中

也就是说：

- 每个响应式数据（例如一个 ref 或 reactive 的某个字段）都会有一个自己的“dep”（依赖集合）

- 每个 effect（例如 watch、watchEffect、组件渲染 effect）也会有一个 deps 数组，记录它正在依赖哪些 dep

它们之间是 双向绑定关系。

✔ “deps” 就是 ReactiveEffect 实例内部的 deps

✔ 它记录了该 effect 依赖的所有响应式数据的 dep

✔ 每个 dep 内部也记录所有依赖它的 effect

✔ 这是 Vue 响应式系统的核心“双向依赖”结构
